FIDO2设备工作流程：
1，设备初始化，创建CA的公钥，私钥，和证书
2，创建生成凭据的公钥，私钥和基于上面CA证书的凭据证书。
3，创建pin通信的公钥私钥
4, 客户端请求MakeCredential。
5，设备检测是否支持pin，若是则检测是否已经设置pin
6，若未设置pin，则返回错误码，告诉client需要设置pin
7，客户端发送getKeyAgreement获取密钥交换信息，计算共享密钥
8，客户端使用共享密钥对用户输入密码进行加密，将加密后的密码和自己的公钥信息一并发送给设备
9，设备收到setPIN请求后，使用客户端发送过来的公钥信息生成共享密钥，使用共享密钥对加密过的pin码进行解密，然后记录pin码的hash值
10，客户端发送getPINToken请求，设备使用共享密钥对发送过来的加密过的pinHash进行解密，并于本地记录的pinHash进行对比验证，若匹配则返回使用共享密钥加密过的pinToken
11，这时设备已经完成了pin码的设置和pinToken的获取，若设备不支持pin，则没有6~10的步骤
12，继续接着步骤5，若设备支持pin并且pin已经设置，则根据客户端的请求对pinToken进行校验，如果pinToken校验失败，则返回pin码错误信息。
13，设备不支持pin，或者pinToken校验成功后，设备开始创建凭证，创建凭证前设备会通过一定的方式弹出认证UI，让用户决定是否允许创建凭证。
14，用户允许后，设备开始创建凭证信息并将凭证信息发送给客户端，然后本地存储一份。凭据信息包含证书，公钥，和随机生成的凭据ID。
15，客户端请求GetAssertion认证，设备根据客户端传递过来的凭据ID查找本地是否存在对应的凭据信息。
16，若不存在，则返回凭据不存在的错误信息。
17，若存在，则对token，rp等信息进行简单校验，然后将客户端传递过来的clientDataHash，rp信息，和本地存储的凭据相关信息一并发送给客户端，并对这些数据进行签名。
18，客户端收到设备发送的Assertion数据，使用设备的公钥进行校验，然后对发送过来的凭证信息进行对比认证。
